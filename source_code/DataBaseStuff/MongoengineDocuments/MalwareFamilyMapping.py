from mongoengine import StringField, ListField
from DataBaseStuff.MongoengineDocuments.BaseDocuments import AbstractNormalDocument


class MalwareFamilyMapping(AbstractNormalDocument):
    meta = {'collection': 'malware_family_mapping'}
    system_name = StringField(required=True)
    variants = ListField()

    def get_family_mapping(self, name_from_source: str):
        try:
            name = MalwareFamilyMapping.objects.get(__raw__={'variants': name_from_source})
        except Exception:
            return name_from_source
        else:
            return name
